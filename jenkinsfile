pipeline{
    agent any
    environment {
    PATH = "${PATH}:${getterraformPath()}"
    }
    stages{
        stage('terraform init'){
            steps{
                sh "terraform init"
            }
        }
        
        stage('terraform format'){
            steps{
                sh "terraform plan"
            }
        }
        
       stage('TF Apply') {
          steps {
         
          sh terraform apply -input=false myplan'
        
      }
    }
    }
      
}
def getterraformPath(){
   def tfhome = tool name: 'terraform', type: 'terraform'
   return tfhome
}
